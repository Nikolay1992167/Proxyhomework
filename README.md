# Задание

1. Взять за основу проект с кешом.
2. Придерживаться GitFlow: master->develop->feature/fix.
3. Реализовать печать документов .pdf файл. 
    1. Можно использовать сторонние либы, например itextpdf.
    2. Использовать подложку из папки д/з.
    3. Использовать предметную область из задания с кешом.
4. Рефакторинг кода с применением паттернов и функционального стиля.
5. Покрыть код тестами.

# Pattern

Согласно условиям задачи был применён проект, в котором выполнена реализация кэша, используя алгоритмы на выбор LRU или LFU. 
Алгоритм для работы приложения и размер коллекции указываются в файле resources/application.yaml. 
В приложении реализованы слои service, dao согласно условиям задания. В сервисе реализованы CRUD операции для
работы с entity Car. В качестве id используется тип UUID.  Данные для подключения к БД также считываются из файла 
application.yaml. Создание таблиц в БД и вставка данных осуществляется чтением файла create_sql_V1.sql. Взаимодействие
с БД осуществлено посредствам JDBC Template. Взаимодействие dao слоя с cache реализовано с помощью кастомной аннотации,
которую отслеживает InvocationHandler и выполняет функциональность работы с cache согласно типу метода. В приложении 
выполнена валидация объекта CarDto c применением регулярных выражений при помощи библиотеки javax.validation. В приложении 
реализована функциональность добавления объектов в файл report+UUID.xml для каждого объекта, куда записываются объекты 
добавленные в cache. Для этого была применена библиотека jackson. 
Применён паттерн "Factory Method" для объектов, выполняющих логику кэширования, создан интерфейс CacheFactory,
содержащий метод Cache <K, V> createCacheType(). 
Реализация создания документа в формате pdf, выполнена с использованием itextpdf. Создал интерфейс ServicePdf, 
включающий метод Path createReportPdf(String cache, String action, Car car, String cacheAction), который принимает 
4 параметра: cache, action, car и cacheAction, представляющие собой данные, необходимые для создания PDF-отчета.
Создаются объекты типа Document и PdfWriter, используя библиотеку itextpdf. В качестве фонового изображения 
используется файл Clevertec_Template.pdf. Для добавления данных используются объекты типа Paragraph, которые представляют
собой абзацы текста в pdf файле. Реализована обработка возможных исключений типа DocumentException и IOException, 
используя блок try-catch-finally, который выбрасывает PDFCreatingException. Файл отчета сохраняется в папку resources/pdf 
с именем, которое формирует метод getPath(). Метод getPath() определяет путь для сохранения созданного файла.

### Технологии применённые в проекте

* Java 17
* Gradle 8.1.1
* Reflections 0.10.2
* Postgresql 42.6.0
* Logback 1.4.11
* Snakeyaml 2.1
* Mapstruct 1.5.5.Final
* Jackson 2.16.0
* Mockito-junit-jupiter 5.6.0
* Junit-bom 5.9.2
* Junit-jupiter
* Assertj-core:3.24.2
* Javax.validation: 2.0.1.Final
* ITextPdf: 5.5.13.3

### Unit тесты

Модульные тесты выполнены с использованием библиотеки AssertJ. 
Написано 61 тест для cache, dao, mapper, pdf, proxy, service. 
Вы можете запустить тесты для этого проекта, выполнив в корне проекта:
```
./gradlew test
```
Один тест для проверки выброса исключения при создании pdf файла не получилось реализовать.

### Функциональность

В приложении используется БД Postgres. Первоначально необходимо создать самостоятельно базу данных cars и настроить
application.yaml. 
Старт приложения осуществляется из класса Main: 
1. Выполнить метод extracted(). В результате в БД будет создана таблица cars. В таблицу будут внесены 2 записи.
2. Закомментировать метод extracted().
3. Раскомментировать метод startApplication().
4. Из таблицы cars необходимо скопировать значения id и использовать их как аргументы метода startApplication().
Например: В таблице 1. id = 0a9498a7-14b1-41b7-8cd0-5ff1eaaa1c22, 2. id = e43791ac-e10b-4daa-9d2f-ad5dfb4410cb. 
startApplication("0a9498a7-14b1-41b7-8cd0-5ff1eaaa1c22", "0a9498a7-14b1-41b7-8cd0-5ff1eaaa1c22",
"e43791ac-e10b-4daa-9d2f-ad5dfb4410cb")
5. Выполнить метод startApplication.
6. В результате в консоли мы получим результат работы будут
   1. выведены:
```
Проверка выполнения программы
11:35:37.852 [main] INFO by.clevertec.proxy.factory.ActionFactory -- Объект добавлен в кэш: Car(id=null, name=Ладушка, description=Почти хороший автомобиль!, price=105000, created=null)
11:35:37.884 [main] INFO by.clevertec.proxy.factory.ActionFactory -- Объект добавлен в кэш: Car(id=849c5f66-1fa1-44ad-92d1-87250b4d50ac, name=BMW, description=Быстрая машина!, price=80000.0, created=2023-11-13T12:00)
11:35:37.885 [main] INFO by.clevertec.proxy.factory.ActionFactory -- Объект получен из кэш: Car(id=849c5f66-1fa1-44ad-92d1-87250b4d50ac, name=BMW, description=Быстрая машина!, price=80000.0, created=2023-11-13T12:00)
11:35:37.906 [main] INFO by.clevertec.proxy.factory.ActionFactory -- Объект обновлён в кэш: Car(id=849c5f66-1fa1-44ad-92d1-87250b4d50ac, name=Москвич, description=Был хорошим авто наверное!, price=105000, created=2023-11-13T12:00)
[InfoCarDto[id=b72a5ffb-2831-4cf7-9554-b43a7a3002ae, name=Ладушка, description=Почти хороший автомобиль!, price=105000, created=2023-11-30T11:35:37.454199], InfoCarDto[id=849c5f66-1fa1-44ad-92d1-87250b4d50ac, name=Москвич, description=Был хорошим авто наверное!, price=105000, created=2023-11-13T12:00]]

```
   2. Созданы два файла xml, содержащие объекты.
   3. Созданы 4 файла pdf, содержащих отчёты о проделанных операциях, в папке src/main/resources/pdf.

Благодарю за уделённое время! Буду рад детальному ревью и хотел бы услышать мнение о README.md.